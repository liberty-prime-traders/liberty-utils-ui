<div class="grid p-3">
  <div class="col-4">
    <p-card [style]="{ border: '1px solid grey'}">
      <div class="flex justify-content-between mb-2 text-500">
        <span>Total Owed to You</span>
        <i class="pi pi-arrow-up-right text-green-500"></i>
      </div>

      <div class="text-2xl font-bold text-green-600">
        ${{ totalDebitAmount() | number:'1.2-2' }}
      </div>

      <div class="text-sm text-500">
        From {{ uniqueDebitPeopleCount() }} people
      </div>
    </p-card>
  </div>

  <div class="col-4">
    <p-card [style]="{ border: '1px solid grey'}">
      <div class="flex justify-content-between mb-2 text-500">
        <span>Total You Owe</span>
        <i class="pi pi-arrow-down-right text-red-500"></i>
      </div>

      <div class="text-2xl font-bold text-red-600">
        ${{ totalCreditAmount() | number:'1.2-2' }}
      </div>

      <div class="text-sm text-500">
        To {{ uniqueCreditPeopleCount() }} people
      </div>
    </p-card>
  </div>

  <div class="col-4">
    <p-card [style]="{ border: '1px solid grey'}">
      <div class="flex justify-content-between mb-2 text-500">
        <span>Net Balance</span>
        <i class="pi pi-calculator"></i>
      </div>

      <div class="text-2xl font-bold">
        ${{ (totalDebitAmount() - totalCreditAmount()) | number:'1.2-2' }}
      </div>

      <div class="text-sm text-500">
        Updated {{ now() | date:'shortTime' }}
      </div>
    </p-card>
  </div>

  <div class="col-12">
    <p-card [style]="{ border: '1px solid grey'}">
      <div class="text-xl font-bold mb-3">Recent Activity</div>

      <p-table [value]="recentTransactions()" class="p-datatable-sm" responsiveLayout="scroll">
        <ng-template pTemplate="header">
          <tr>
            <th>Date</th>
            <th>Person</th>
            <th>Description</th>
            <th class="text-right">Amount</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-t>
          <tr>
            <td>{{ t.transactionDate | date:'mediumDate' }}</td>
            <td>{{ t.contactName }}</td>
            <td>{{ t.description }}</td>
            <td class="text-right"
                [ngClass]="{
                'text-green-500': t.transactionType === TransactionType.CREDIT,
                'text-red-500': t.transactionType === TransactionType.DEBIT
              }">
              {{ t.transactionType === TransactionType.CREDIT ? '+' : '-' }}
              {{ t.amount | currency:'USD' }}
            </td>
          </tr>
        </ng-template>
      </p-table>
      <div class="text-center py-2">
        <a href="/secure/debt-tracker/transactions" class="no-underline">View Transactions</a>
      </div>
      <div *ngIf="recentTransactions().length === 0" class="text-center text-500 py-4">
        No transactions.
      </div>
    </p-card>
  </div>


  <div class="col-12 md:col-6">
    <p-card [style]="{ border: '1px solid grey', height: '100%'}">
      <div class="text-lg font-semibold mb-2">Top Debtors</div>
      <div *ngFor="let d of topDebtors()" class="flex justify-content-between py-2 border-bottom-1 surface-border">
        <div>
          <div class="font-bold">{{ d.name }}</div>
          <div class="text-xs text-500">Last transaction: {{ d.lastTransactionDate | date }}</div>
        </div>
        <div>
          <div class="font-bold text-green-600">${{ d.total | number:'1.2-2' }}</div>
          <a href="/secure/debt-tracker/people/{{d.id}}" class="no-underline">Details</a>
        </div>
      </div>
    </p-card>
  </div>

  <div class="col-12 md:col-6">
    <p-card [style]="{ border: '1px solid grey', height: '100%' }">
      <div class="text-lg font-semibold mb-2">Top Creditors</div>
      <div *ngFor="let c of topCreditors()" class="flex justify-content-between py-2 border-bottom-1 surface-border">
        <div>
          <div class="font-bold">{{ c.name }}</div>
          <div class="text-xs text-500">Last transaction: {{ c.lastTransactionDate | date }}</div>
        </div>
        <div>
          <div class="font-bold text-red-600">${{ c.total | number:'1.2-2' }}</div>
          <a href="/secure/debt-tracker/people/{{c.id}}" class="no-underline">Details</a>
        </div>
      </div>
    </p-card>
  </div>
</div>
